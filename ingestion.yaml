# copy-paste this template into a data_ingestion_template.yaml before using
# as a best practice, config.yaml must not be committed to github
# as it may contain sensitive information about the data.
#
# See data_ingestion_template_schema.yaml for valid values

# the name of requestor
REQUESTOR: jane

# the department to which the requestor belongs
REQUESTOR_DEPARTMENT: gynocology

# email address of requestor
REQUESTOR_EMAIL: jane@mskcc.org

# project name decided by data coordination
PROJECT: OV_16-158

# source name of input data file
SOURCE: xnat

# data modality
MODALITY: radiology

# data type within the modality
DATA_TYPE: CT

# description of the template defined by the requestor
COMMENTS:

# size of expected data transfer
DATA_SIZE: 132433

# the data on which the request was made
DATE: 20201029

# name to be given to the dataset
DATASET_NAME: OV_16-158_CT_20201028

# Type of ETL
ETL_TYPE: radiology_proxy

# input source file
FILE_TYPE: dcm

# leave as "delta" since we use delta table format
FORMAT_TYPE: delta

# ip or hostname of machine where source data file(s) reside, if applicable
HOST: 

# file path to the source data file(s). if host is specified, the source data location is determined
# as host:source_path, else the source data location is determined simply as source_path.

SOURCE_PATH: /mskmind_XNAT/330680

# TODO: yaml variable replacement 

# root path for tables and file transfer
# LANDING_PATH: /gpfs/mskmindhdp_emc/user/pateld6/data-processing/${DATASET_NAME}
LANDING_PATH: /gpfs/mskmindhdp_emc/user/aukermaa/radiology/OV_16-158_CT_20201028

# location where the data should be transferred on the destination machine.
# RAW_DATA_PATH: ${LANDING_PATH}/raw_data
RAW_DATA_PATH: /gpfs/mskmindhdp_emc/user/aukermaa/radiology/OV_16-158_CT_20201028/raw_data

# location for where tables are created 
# TABLE_PATH: ${LANDING_PATH}/table
TABLE_PATH: /gpfs/mskmindhdp_emc/user/aukermaa/radiology/OV_16-158_CT_20201028/table

# location where the data should be transferred on the destination machine.
# RAW_DATA_PATH: ${LANDING_PATH}/raw_data
TMPJSON_PATH: /gpfs/mskmindhdp_emc/user/aukermaa/radiology/OV_16-158_CT_20201028/raw_json


# a file containing names of files and sub-directories that exist under the source_path of the remote system and that
# need to be transferred. One name should be placed on each line. An easy way to generate such a file is by changing
# directory to the source_path on the remote file system and executing 'ls -1 . > chunks.txt' and then moving chunks.txt
# to the destination file system.
CHUNK_FILE: chunk_files.txt

# total number of input data files to process
FILE_COUNT: 556 

# TODO data size (in bytes). Document find command here to get data size from source system"


# limit socket I/O bandwidth. Set this limit based on available bandwidth between the source
# and destination servers. The bandwidth can be measured as follows:
# on source machine, start an iperf3 server
# $ iperf3 -s
# -----------------------------------------------------------
# Server listening on 5201
# -----------------------------------------------------------
# on the destination machine, start an iperf3 client
# iperf3 -c <source_machine> -p <listening_port>
# Connecting to host <source_machine>, port 5201
# - - - - - - - - - - - - - - - - - - - - - - - - -
# [ ID] Interval           Transfer     Bandwidth       Retr
# [  4]   0.00-10.00  sec  10.7 GBytes  9.20 Gbits/sec    0             sender
# [  4]   0.00-10.00  sec  10.7 GBytes  9.19 Gbits/sec                  receiver
# iperf Done.
#
# be nice and don't use all available bandwidth. Use up to 50% available bandwidth. The amount specified
# here is the total bandwidth that will be used by all processes that are spawned for the data transfer.
BWLIMIT: 5G
